import { Avatar,Dropdown, Menu, message } from 'antd'
import React from 'react'
import { Link, withRouter } from 'react-router-dom'
import "./index.css";
const MenuItem = Menu.Item;

function NavBar(props) {
    // console.log(props)
    const teacherId = props.teacherInfo.teacherId;
    
    const pathLevel = props.location.pathname.split('/').filter(i => i).length;

    const handleSignOut = () => {
        window.localStorage.setItem('loginState', 0);
        props.history.replace('/');
        message.success('您已退出!');
    }

    const menu = (
        <Menu style={{ marginTop: "10px", textAlign: "center" }}>
            <MenuItem key="1"><Link to={`/teacher/profile/${teacherId}`}>个人中心</Link></MenuItem>
            <MenuItem key="2">学生管理</MenuItem>
            <MenuItem key="3">课程管理</MenuItem>
            <MenuItem key="4" onClick={handleSignOut}>退出</MenuItem>
        </Menu>
    );

    return (
        <div className="teacher-navbar">
            { pathLevel === 1 ? 
                <div className="nav-tip">
                    <Link to="/teacher">
                        <svg width="80" height="30" viewBox="0 0 80 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="0.375" y="0.375" width="79.25" height="29.25" rx="2.625" fill="white" stroke="#0C0C0C" stroke-width="0.75" stroke-linecap="square" stroke-linejoin="bevel"/>
                            <path d="M3.50781 11.6094L11.0234 14.7344V16.3281L3.50781 19.4688V17.4062L8.14844 15.5391L3.50781 13.6797V11.6094Z" fill="black"/>
                            <path d="M21.6406 9.35156V11.8828H19.6875V22H16.3984V11.8828H14.4531V9.35156H21.6406Z" fill="#0A0083"/>
                            <path d="M26.7469 9.35156V11H23.4969V9.35156H26.7469ZM26.7469 11.6328V22H23.4969V11.6328H26.7469Z" fill="#1B1B1B"/>
                            <path d="M36.8609 14.8672H33.5719V12.6641C33.5719 12.0234 33.5354 11.625 33.4625 11.4688C33.3948 11.3073 33.2411 11.2266 33.0016 11.2266C32.7307 11.2266 32.5589 11.3229 32.4859 11.5156C32.413 11.7083 32.3766 12.125 32.3766 12.7656V18.6406C32.3766 19.2552 32.413 19.6562 32.4859 19.8438C32.5589 20.0312 32.7229 20.125 32.9781 20.125C33.2229 20.125 33.3818 20.0312 33.4547 19.8438C33.5328 19.6562 33.5719 19.2161 33.5719 18.5234V16.9375H36.8609V17.4297C36.8609 18.737 36.7672 19.6641 36.5797 20.2109C36.3974 20.7578 35.9885 21.237 35.3531 21.6484C34.7229 22.0599 33.9443 22.2656 33.0172 22.2656C32.0536 22.2656 31.2594 22.0911 30.6344 21.7422C30.0094 21.3932 29.5953 20.9115 29.3922 20.2969C29.1891 19.6771 29.0875 18.7474 29.0875 17.5078V13.8125C29.0875 12.901 29.1187 12.2188 29.1812 11.7656C29.2437 11.3073 29.4286 10.8672 29.7359 10.4453C30.0484 10.0234 30.4781 9.69271 31.025 9.45312C31.5771 9.20833 32.2099 9.08594 32.9234 9.08594C33.8922 9.08594 34.6917 9.27344 35.3219 9.64844C35.9521 10.0234 36.3661 10.4922 36.5641 11.0547C36.762 11.612 36.8609 12.4818 36.8609 13.6641V14.8672Z" fill="#C80101"/>
                            <path d="M42.3031 9.35156V12.1953C42.574 11.9453 42.8656 11.7578 43.1781 11.6328C43.4958 11.5078 43.8344 11.4453 44.1937 11.4453C44.7458 11.4453 45.2146 11.5859 45.6 11.8672C45.9906 12.1484 46.2276 12.474 46.3109 12.8438C46.3995 13.2083 46.4437 13.8776 46.4437 14.8516V22H43.2875V14.7031C43.2875 14.099 43.2562 13.7109 43.1937 13.5391C43.1365 13.3672 43.0036 13.2812 42.7953 13.2812C42.6026 13.2812 42.4724 13.3698 42.4047 13.5469C42.337 13.724 42.3031 14.0755 42.3031 14.6016V22H39.1469V9.35156H42.3031ZM51.9875 9.35156V11H48.7375V9.35156H51.9875ZM51.9875 11.6328V22H48.7375V11.6328H51.9875ZM57.5391 11.6328L57.4844 12.5859C57.7135 12.2057 57.9922 11.9219 58.3203 11.7344C58.6536 11.5417 59.0365 11.4453 59.4688 11.4453C60.0104 11.4453 60.4531 11.5729 60.7969 11.8281C61.1406 12.0833 61.362 12.4062 61.4609 12.7969C61.5599 13.1823 61.6094 13.8281 61.6094 14.7344V22H58.4531V14.8203C58.4531 14.1068 58.4297 13.6719 58.3828 13.5156C58.3359 13.3594 58.2057 13.2812 57.9922 13.2812C57.7682 13.2812 57.6276 13.3724 57.5703 13.5547C57.513 13.7318 57.4844 14.2109 57.4844 14.9922V22H54.3281V11.6328H57.5391ZM71.075 11.6328V19.6172C71.075 20.6953 71.049 21.3932 70.9969 21.7109C70.95 22.0234 70.7755 22.3542 70.4734 22.7031C70.1714 23.0573 69.7495 23.3255 69.2078 23.5078C68.6714 23.6953 67.9943 23.7891 67.1766 23.7891C66.1714 23.7891 65.3641 23.6172 64.7547 23.2734C64.1453 22.9349 63.8302 22.2656 63.8094 21.2656H66.8719C66.8719 21.724 67.0385 21.9531 67.3719 21.9531C67.6115 21.9531 67.7703 21.8828 67.8484 21.7422C67.9266 21.6016 67.9656 21.3073 67.9656 20.8594V20.0781C67.6948 20.3229 67.4083 20.5078 67.1063 20.6328C66.8094 20.7578 66.4969 20.8203 66.1688 20.8203C65.601 20.8203 65.1323 20.7057 64.7625 20.4766C64.3979 20.2474 64.1479 19.9479 64.0125 19.5781C63.8771 19.2031 63.8094 18.6719 63.8094 17.9844V14.2188C63.8094 13.2344 63.9865 12.526 64.3406 12.0938C64.6948 11.6615 65.2339 11.4453 65.9578 11.4453C66.3536 11.4453 66.713 11.526 67.0359 11.6875C67.3641 11.849 67.6557 12.0911 67.9109 12.4141L68.1375 11.6328H71.075ZM67.9109 14.3828C67.9109 13.9089 67.8823 13.6068 67.825 13.4766C67.7729 13.3464 67.6531 13.2812 67.4656 13.2812C67.2833 13.2812 67.1531 13.3568 67.075 13.5078C67.0021 13.6536 66.9656 13.9453 66.9656 14.3828V17.8672C66.9656 18.3307 66.9943 18.6328 67.0516 18.7734C67.1089 18.9089 67.2286 18.9766 67.4109 18.9766C67.6193 18.9766 67.7547 18.8932 67.8172 18.7266C67.8797 18.5599 67.9109 18.1823 67.9109 17.5938V14.3828Z" fill="#1B1B1B"/>
                        </svg>
                    </Link>
                </div>
             : 
                <div className="nav-tip">
                    <Link to="/teacher">回到首页</Link>
                </div>
            }
            
            {/* Dropdown */}
            <div className="teacher-avatar">
                <Dropdown
                    placement="bottomCenter"
                    overlay={menu}
                >
                    <Link to={`/teacher/profile/${teacherId}`}>
                        <Avatar
                            style={{ marginBottom: "2px" }}
                            size="large"
                            src={props.teacherInfo.avatar}
                        />
                    </Link>
                </Dropdown>
            </div>
        </div>
    )
}

export default withRouter(NavBar);
